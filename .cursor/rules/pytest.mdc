---
description: pytest 测试规范，生成或修改测试文件时适用
globs: ["test_*.py", "*_test.py", "conftest.py"]
alwaysApply: false
---
- 结构：AAA（注释标注 # Arrange / # Act / # Assert）
- 命名：test_<fn>_<scenario>_<expected>
- 相似用例：@pytest.mark.parametrize 合并
- 浮点比较：pytest.approx
- 异常断言：pytest.raises(Type, match="pattern")
- Mock：mocker fixture only，禁止直接 import unittest.mock
- 公共 fixture：放 conftest.py，scope 显式声明
- 覆盖：正常路径 + 边界值 + 异常路径
